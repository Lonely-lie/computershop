<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.computershop.mapper.OrderItemMapper">

    <resultMap type="orderItem" id="OrderItemResult">
        <id property="id" column="id"/>
        <result property="pro_id" column="pro_id"/>
        <result property="order_id" column="order_id"/>
        <result property="user_id" column="user_id"/>
        <result property="number" column="number"/>

    </resultMap>


    <select id="findByOrderOrderByIdDesc" resultMap="OrderItemResult">
    SELECT * FROM order_item  WHERE order_id=#{order_id}
    </select>
    <select id="findByPid" resultMap="OrderItemResult">
    SELECT * FROM order_item  WHERE pro_id=#{pid}
    </select>

    <select id="findCartByUid" resultMap="OrderItemResult">
    SELECT * FROM order_item  WHERE user_id=#{uid} and order_id is null
    </select>

    <update id="update" parameterType="orderItem">
        update order_item
        set
        pro_id=#{pro_id},user_id=#{user_id},number=#{number},order_id=#{order_id}
        where id=#{id}
    </update>

    <update id="foreChangeCartNumber" parameterType="int">
        update order_item
        set
        number=#{number}
        where user_id=#{user_id} and pro_id=#{pro_id} and order_id is null
    </update>

    <insert id="add" parameterType="orderItem" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO order_item(pro_id,user_id,number)
        VALUES(#{pro_id},#{user_id},#{number})
    </insert>
    <delete id="deleteOrderItem" parameterType="int">
        delete from order_item where id=#{oiid}
    </delete>


    <select id="findByOrderItemId" parameterType="int" resultMap="OrderItemResult">
        SELECT * from  order_item where id=#{oiid}
    </select>
</mapper>

